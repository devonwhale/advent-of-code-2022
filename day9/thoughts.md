Oh, I really didn't do myself any favours here. Didn't read the instructions, made a couple of dangerous assumptions and ignored the second example input. 

(Also, you might spot a good old fashioned "This shouldn't be possible" log statement. It was so useful to me that t wouldn't have felt right removing it.)
